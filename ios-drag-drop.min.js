/*! drag-drop-webkit-mobile 0.2.4 | Copyright (c) 2014 Tim Ruffles | BSD 2 License */!function(a){function b(){l=navigator.userAgent.match(/OS 5(?:_\d+)+ like Mac/)?"client":"page";var b=a.createElement("div");dragDiv="draggable"in b,evts="ondragstart"in b&&"ondrop"in b;var c=!(dragDiv||evts)||/iPad|iPhone|iPod/.test(navigator.userAgent);j((c?"":"not ")+"patching html5 drag drop"),a.addEventListener("touchstart",d)}function c(a,b){this.touchPositions={},this.dragData={},this.el=b||a.target,a.preventDefault(),j("dragstart"),this.dispatchDragStart(),this.elTranslation=f(this.el),this.listen()}function d(b){var d=b.target;do d.hasAttribute("draggable")&&(b.preventDefault(),new c(b,d));while((d=d.parentNode)&&d!==a.body)}function e(b,c){var d=b.parentElement,e=b.nextSibling;d.removeChild(b);var f=c.changedTouches[0];return target=a.elementFromPoint(f[l+"X"],f[l+"Y"]),e?d.insertBefore(b,e):d.appendChild(b),target}function f(a){var b=a.style["-webkit-transform"],c=0,d=0,e=/translate\(\s*(\d+)[^,]*,\D*(\d+)/.exec(b);return e&&(c=parseInt(e[1],10),d=parseInt(e[2],10)),{x:c,y:d}}function g(a,b,c){var d=a.style["-webkit-transform"].replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"");a.style["-webkit-transform"]=d+" translate("+b+"px,"+c+"px)"}function h(a,b,c,d){return d&&(c=c.bind(d)),a.addEventListener(b,c),{off:function(){return a.removeEventListener(b,c)}}}function i(a,b,c,d){function e(d){return c(d),a.removeEventListener(b,e)}return d&&(c=c.bind(d)),a.addEventListener(b,e)}function j(a){console.log(a)}function k(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}j=function(){},b();var l;c.prototype={listen:function(){function b(a){this.dragend(a,a.target),c()}function c(){return j("cleanup"),this.touchPositions={},this.el=this.dragData=null,[d,e,f].forEach(function(a){return a.off()})}var d=h(a,"touchmove",this.move,this),e=h(a,"touchend",b,this),f=h(a,"touchcancel",c,this)},move:function(a){var b={x:[],y:[]};[].forEach.call(a.changedTouches,function(a,c){var d=this.touchPositions[c];d?(b.x.push(a.pageX-d.x),b.y.push(a.pageY-d.y)):this.touchPositions[c]=d={},d.x=a.pageX,d.y=a.pageY}.bind(this)),this.elTranslation.x+=k(b.x),this.elTranslation.y+=k(b.y),g(this.el,this.elTranslation.x,this.elTranslation.y)},dragend:function(b){j("dragend");var c=e(this.el,b);c?(j("found drop target "+c.tagName),this.dispatchDrop()):(j("no drop target, scheduling snapBack"),i(a,"dragend",this.snapBack,this));var d=a.createEvent("Event");d.initEvent("dragend",!0,!0),this.el.dispatchEvent(d)},dispatchDrop:function(){var b=!0,c=a.createEvent("Event");c.initEvent("drop",!0,!0),c.dataTransfer={getData:function(a){return this.dragData[a]}.bind(this)},c.preventDefault=function(){b=!1,g(this.el,0,0)}.bind(this),i(a,"drop",function(){j("drop event not canceled"),b&&this.snapBack()},this),target.dispatchEvent(c)},snapBack:function(){i(this.el,"webkitTransitionEnd",function(){this.el.style["-webkit-transition"]="none"},this),setTimeout(function(){this.el.style["-webkit-transition"]="all 0.2s",g(this.el,0,0)}.bind(this))},dispatchDragStart:function(){var b=a.createEvent("Event");b.initEvent("dragstart",!0,!0),b.dataTransfer={setData:function(a,b){this.dragData[a]=b}.bind(this),dropEffect:"move"},this.el.dispatchEvent(b)}}}(document);