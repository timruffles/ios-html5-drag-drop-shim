/*! drag-drop-polyfill 2.0.0-beta.3 | Copyright (c) 2017 Tim Ruffles | BSD 2 License */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.DragDropPolyfill=a.DragDropPolyfill||{})}(this,function(a){"use strict";function b(){var a={dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,touchEvents:"ontouchstart"in document.documentElement,userAgentSupportingNativeDnD:void 0},b=!!window.chrome||/chrome/i.test(navigator.userAgent);return a.userAgentSupportingNativeDnD=!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||b&&a.touchEvents),z&&Object.keys(a).forEach(function(a){}),a}function c(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b)}catch(a){}return a}function d(a){if(a&&Object.keys(a).forEach(function(b){A[b]=a[b]}),!A.forceApply){var d=b();if(d.userAgentSupportingNativeDnD&&d.draggable&&d.dragEvents)return}w=c(),h("touchstart",e,!1)}function e(a){if(!x){var b=f(a);if(b)try{x=new L(a,A,b,g)}catch(b){throw g(A,a,y.CANCELLED),b}}}function f(a){var b=a.target;do if(b.draggable!==!1&&b.getAttribute&&"true"===b.getAttribute("draggable"))return b;while((b=b.parentNode)&&b!==document.body)}function g(a,b,c){if(c===y.POTENTIAL&&a.defaultActionOverride)try{a.defaultActionOverride(b),b.defaultPrevented}catch(a){}x=null}function h(a,b,c){void 0===c&&(c=!0),document.addEventListener(a,b,!!w&&{passive:c})}function i(a,b){document.removeEventListener(a,b)}function j(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}function k(a){return a&&a.tagName}function l(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];if(d.identifier===b)return!0}return!1}function m(a,b,c,d,e,f,g){void 0===g&&(g=null);var h=b.changedTouches[0],i=new Event(c,{bubbles:!0,cancelable:d});i.dataTransfer=f,i.relatedTarget=g,i.screenX=h.screenX,i.screenY=h.screenY,i.clientX=h.clientX,i.clientY=h.clientY,i.pageX=h.pageX,i.pageY=h.pageY;var j=a.getBoundingClientRect();return i.offsetX=i.clientX-j.left,i.offsetY=i.clientY-j.top,i}function n(a,b,c){for(var d=[],e=[],f=0;f<b.touches.length;f++){var g=b.touches[f];d.push(g[a+"X"]),e.push(g[a+"Y"])}c.x=j(d),c.y=j(e)}function o(a,b){if(1===a.nodeType){for(var c=getComputedStyle(a),d=0;d<c.length;d++){var e=c[d];b.style.setProperty(e,c.getPropertyValue(e),c.getPropertyPriority(e))}b.style.pointerEvents="none",b.removeAttribute("id"),b.removeAttribute("class"),b.removeAttribute("draggable")}if(a.hasChildNodes())for(var d=0;d<a.childNodes.length;d++)o(a.childNodes[d],b.childNodes[d])}function p(a){var b=a.cloneNode(!0);return o(a,b),b.style.position="absolute",b.style.left="0px",b.style.top="0px",b.style.zIndex="999999",b.classList.add(I),b.classList.add(K),b}function q(a){return G.map(function(b){var c=a.style[b+"transform"];return c&&"none"!==c?c.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""})}function r(a,b,c,d,e){void 0===e&&(e=!0);var f=b.x,g=b.y;d&&(f+=d.x,g+=d.y),e&&(f-=parseInt(a.offsetWidth,10)/2,g-=parseInt(a.offsetHeight,10)/2);for(var h="translate3d("+f+"px,"+g+"px, 0)",i=0;i<G.length;i++){var j=G[i]+"transform";a.style[j]=h+" "+c[i]}}function s(a,b,c,d){var e=getComputedStyle(a);if("hidden"===e.visibility||"none"===e.display)return void d();b.classList.add(J);var f=getComputedStyle(b),g=parseFloat(f.transitionDuration);if(isNaN(g)||0===g)return void d();var h=a.getBoundingClientRect(),i={x:h.left,y:h.top};i.x+=document.body.scrollLeft||document.documentElement.scrollLeft,i.y+=document.body.scrollTop||document.documentElement.scrollTop,i.x-=parseInt(e.marginLeft,10),i.y-=parseInt(e.marginTop,10);var j=parseFloat(f.transitionDelay),k=Math.round(1e3*(g+j));r(b,i,c,void 0,!1),setTimeout(d,k)}function t(a,b){return a?a===D[B.NONE]?F[C.NONE]:0===a.indexOf(D[B.COPY])||a===D[B.ALL]?F[C.COPY]:0===a.indexOf(D[B.LINK])?F[C.LINK]:a===D[B.MOVE]?F[C.MOVE]:F[C.COPY]:3===b.nodeType&&"A"===b.tagName?F[C.LINK]:F[C.COPY]}function u(a,b,c,d,e,f,g){if(void 0===f&&(f=!0),void 0===g&&(g=null),z){var h=H+"debug",i=H+"event-target",j=H+"event-related-target";b.classList.add(h),b.classList.add(i),g&&(g.classList.add(h),g.classList.add(j))}var k=m(b,c,a,f,document.defaultView,e,g),l=!b.dispatchEvent(k);return d.g=E.h,z&&(b.classList.remove(i),g&&g.classList.remove(j)),l}function v(a,b){if(!a||a===D[7])return b;if(b===F[C.COPY]){if(0===a.indexOf(F[C.COPY]))return F[C.COPY]}else if(b===F[C.LINK]){if(0===a.indexOf(F[C.LINK])||a.indexOf("Link")>-1)return F[C.LINK]}else if(b===F[C.MOVE]&&(0===a.indexOf(F[C.MOVE])||a.indexOf("Move")>-1))return F[C.MOVE];return F[C.NONE]}var w,x,y,z=!1,A={iterationInterval:150};!function(a){a[a.POTENTIAL=0]="POTENTIAL",a[a.STARTED=1]="STARTED",a[a.ENDED=2]="ENDED",a[a.CANCELLED=3]="CANCELLED"}(y||(y={}));var B;!function(a){a[a.NONE=0]="NONE",a[a.COPY=1]="COPY",a[a.COPY_LINK=2]="COPY_LINK",a[a.COPY_MOVE=3]="COPY_MOVE",a[a.LINK=4]="LINK",a[a.LINK_MOVE=5]="LINK_MOVE",a[a.MOVE=6]="MOVE",a[a.ALL=7]="ALL"}(B||(B={}));var C,D=["none","copy","copyLink","copyMove","link","linkMove","move","all"];!function(a){a[a.NONE=0]="NONE",a[a.COPY=1]="COPY",a[a.MOVE=2]="MOVE",a[a.LINK=3]="LINK"}(C||(C={}));var E,F=["none","copy","move","link"],G=["","-webkit-"],H="dnd-poly-",I=H+"drag-image",J=H+"snapback",K=H+"icon",L=function(){function a(a,b,c,d){this.i=a,this.j=b,this.k=c,this.l=d,this.m=y.POTENTIAL,this.o=null,this.p=null,this.q=a,this.s=a.changedTouches[0],this.t=this.u.bind(this),this.v=this.A.bind(this),h("touchmove",this.t,!1),h("touchend",this.v,!1),h("touchcancel",this.v,!1)}return a.prototype.B=function(){var a=this;this.m=y.STARTED,this.C=F[C.NONE],this.D={F:{},G:void 0,g:E.PROTECTED,H:[]},this.I={x:null,y:null},this.J={x:null,y:null};var b=this.k;if(this.K=new M(this.D,function(c,d,e){b=c,"number"!=typeof d&&"number"!=typeof e||(a.L={x:d||0,y:e||0})}),this.D.g=E.READWRITE,this.K.dropEffect=F[C.NONE],u("dragstart",this.k,this.q,this.D,this.K))return this.m=y.CANCELLED,this.M(),!1;if(n("page",this.q,this.J),this.N=p(b),this.O=q(this.N),!this.L)if(this.j.dragImageOffset)this.L={x:this.j.dragImageOffset.x,y:this.j.dragImageOffset.y};else if(this.j.dragImageCenterOnTouch){var c=getComputedStyle(b);this.L={x:0-parseInt(c.marginLeft,10),y:0-parseInt(c.marginTop,10)}}else{var d=b.getBoundingClientRect(),c=getComputedStyle(b);this.L={x:d.left-this.s.clientX-parseInt(c.marginLeft,10)+d.width/2,y:d.top-this.s.clientY-parseInt(c.marginTop,10)+d.height/2}}return r(this.N,this.J,this.O,this.L,this.j.dragImageCenterOnTouch),document.body.appendChild(this.N),this.P=setInterval(function(){a.R||(a.R=!0,a.S(),a.R=!1)},this.j.iterationInterval),!0},a.prototype.M=function(){this.P&&(clearInterval(this.P),this.P=null),i("touchmove",this.t),i("touchend",this.v),i("touchcancel",this.v),this.N&&(this.N.parentNode.removeChild(this.N),this.N=null),this.l(this.j,this.q,this.m)},a.prototype.u=function(a){var b=this;if(l(a,this.s.identifier)!==!1){if(this.q=a,this.m===y.POTENTIAL){var c=void 0;if(this.j.dragStartConditionOverride)try{c=this.j.dragStartConditionOverride(a)}catch(a){c=!1}else c=1===a.touches.length;return c?void(this.B()===!0&&(this.i.preventDefault(),a.preventDefault())):void this.M()}if(a.preventDefault(),n("client",a,this.I),n("page",a,this.J),this.j.dragImageTranslateOverride)try{var d=!1;if(this.j.dragImageTranslateOverride(a,{x:this.I.x,y:this.I.y},this.o,function(a,c){b.N&&(d=!0,b.I.x+=a,b.I.y+=c,b.J.x+=a,b.J.y+=c,r(b.N,b.J,b.O,b.L,b.j.dragImageCenterOnTouch))}),d)return}catch(a){}r(this.N,this.J,this.O,this.L,this.j.dragImageCenterOnTouch)}},a.prototype.A=function(a){if(l(a,this.s.identifier)!==!1){if(this.j.dragImageTranslateOverride)try{this.j.dragImageTranslateOverride(void 0,void 0,void 0,function(){})}catch(a){}if(this.m===y.POTENTIAL)return void this.M();a.preventDefault(),this.m="touchcancel"===a.type?y.CANCELLED:y.ENDED}},a.prototype.S=function(){var a=this;if(z)var b=H+"debug",c=H+"immediate-user-selection",d=H+"current-drop-target";var e=this.C;this.D.g=E.PROTECTED,this.K.dropEffect=F[C.NONE];var f=u("drag",this.k,this.q,this.D,this.K);if(f&&(this.C=F[C.NONE]),f||this.m===y.ENDED||this.m===y.CANCELLED){var g=this.T(this.m);return g?void s(this.k,this.N,this.O,function(){a.U()}):void this.U()}var h=document.elementFromPoint(this.I.x,this.I.y),i=this.p;h!==this.o&&h!==this.p&&(z&&(this.o&&this.o.classList.remove(c),h&&(h.classList.add(b),h.classList.add(c))),this.o=h,null!==this.p&&(this.D.g=E.PROTECTED,this.K.dropEffect=F[C.NONE],u("dragexit",this.p,this.q,this.D,this.K,!1)),null===this.o?this.p=this.o:(this.D.g=E.PROTECTED,this.K.dropEffect=t(this.D.G,this.k),u("dragenter",this.o,this.q,this.D,this.K)?(this.p=this.o,this.C=v(this.K.effectAllowed,this.K.dropEffect)):this.o!==document.body&&(this.p=document.body))),i!==this.p&&k(i)&&(z&&i.classList.remove(d),this.D.g=E.PROTECTED,this.K.dropEffect=F[C.NONE],u("dragleave",i,this.q,this.D,this.K,!1,this.p)),k(this.p)&&(z&&(this.p.classList.add(b),this.p.classList.add(d)),this.D.g=E.PROTECTED,this.K.dropEffect=t(this.D.G,this.k),u("dragover",this.p,this.q,this.D,this.K)===!1?this.C=F[C.NONE]:this.C=v(this.K.effectAllowed,this.K.dropEffect)),e!==this.C&&this.N.classList.remove(H+e);var j=H+this.C;this.N.classList.contains(j)===!1&&this.N.classList.add(j)},a.prototype.T=function(a){if(z){var b=H+"immediate-user-selection",c=H+"current-drop-target";this.p&&this.p.classList.remove(c),this.o&&this.o.classList.remove(b)}var d=this.C===F[C.NONE]||null===this.p||a===y.CANCELLED;return d?k(this.p)&&(this.D.g=E.PROTECTED,this.K.dropEffect=F[C.NONE],u("dragleave",this.p,this.q,this.D,this.K,!1)):k(this.p)&&(this.D.g=E.READONLY,this.K.dropEffect=this.C,u("drop",this.p,this.q,this.D,this.K)===!0?this.C=this.K.dropEffect:this.C=F[C.NONE]),d},a.prototype.U=function(){this.D.g=E.PROTECTED,this.K.dropEffect=this.C,u("dragend",this.k,this.q,this.D,this.K,!1),this.m=y.ENDED,this.M()},a}();!function(a){a[a.h=0]="_DISCONNECTED",a[a.READONLY=1]="READONLY",a[a.READWRITE=2]="READWRITE",a[a.PROTECTED=3]="PROTECTED"}(E||(E={}));var M=function(){function a(a,b){this.V=a,this.W=b,this.X=F[C.NONE]}return Object.defineProperty(a.prototype,"types",{get:function(){if(this.V.g!==E.h)return Object.freeze(this.V.H)},enumerable:!0,configurable:!0}),a.prototype.setData=function(a,b){if(this.V.g===E.READWRITE){if(a.indexOf(" ")>-1)throw new Error("illegal arg: type contains space");this.V.F[a]=b,this.V.H.indexOf(a)===-1&&this.V.H.push(a)}},a.prototype.getData=function(a){if(this.V.g===E.READONLY||this.V.g===E.READWRITE)return this.V.F[a]||""},a.prototype.clearData=function(a){if(this.V.g===E.READWRITE){if(a&&this.V.F[a]){delete this.V.F[a];var b=this.V.H.indexOf(a);return void(b>-1&&this.V.H.splice(b,1))}this.V.F={},this.V.H=[]}},a.prototype.setDragImage=function(a,b,c){this.V.g===E.READWRITE&&this.W(a,b,c)},Object.defineProperty(a.prototype,"effectAllowed",{get:function(){return this.V.G},set:function(a){this.V.g===E.READWRITE&&D.indexOf(a)>-1&&(this.V.G=a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropEffect",{get:function(){return this.X},set:function(a){this.V.g!==E.h&&D.indexOf(a)>-1&&(this.X=a)},enumerable:!0,configurable:!0}),a}();a.polyfill=d,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=drag-drop-polyfill.min.js.map